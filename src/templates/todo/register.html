{% load static %}

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="{% static "user_auth.css" %}">

<div class="container">
    <div class="header">
        <h2>Create Account</h2>
    </div>
    <form class="form" id="form" method="POST" action="" novalidate>
        {% csrf_token %}
        <div class="form-control">
            <label>Username</label>
            {{ form.username }}
            <i class="small material-icons done">done</i>
            <i class="small material-icons error">priority_high</i>
            <small>Error message</small>
        </div>

        <div class="form-control">
            <label>Email</label>
            {{ form.email }}
            <i class="small material-icons done">done</i>
            <i class="small material-icons error">priority_high</i>
            <small>Error message</small>
        </div>

        <div class="form-control">
            <label>Password</label>
            {{ form.password1 }}
            <i class="small material-icons done">done</i>
            <i class="small material-icons error">priority_high</i>
            <small>Error message</small>
        </div>

        <div class="form-control">
            <label>Password check</label>
            {{ form.password2 }}
            <i class="small material-icons done">done</i>
            <i class="small material-icons error">priority_high</i>
            <small>Error message</small>
        </div>

        <button>Submit</button>

        <div class="form-text">
            Already have an account? <a href="{% url 'login' %}" >Login</a>
        </div>

    </form>
</div>

<script>
    const form = document.getElementById('form');
    const username = document.getElementById('id_username');
    const email = document.getElementById('id_email');
    const password1 = document.getElementById('id_password1');
    const password2 = document.getElementById('id_password2');

    username.placeholder = 'todouser17';
    //username.target.setCustomValidity("");
    email.placeholder = 'user@todo.com';
    password1.placeholder = 'Enter password';
    password2.placeholder = 'Check Password';

    form.addEventListener('submit', (e) => {
        console.log('Hi there');
        e.preventDefault();

        checkInputs();
    });


function checkInputs() {
    //get the values from the inputs
    const username_value = username.value.trim();
    const email_value = email.value.trim();
    const password1_value = password1.value.trim();
    const password2_value = password2.value.trim();

    if (username_value === '') {
        setErrorFor(username, 'Username cannot be blank.');
    } else {
        setSuccessFor(username);
    }
}

function setErrorFor(input, message) {
    const form_control = input.parentElement; // .form-control div
    const small_label = form_control.querySelector('small');
    small_label.innerText = message;
    form_control.className = 'form-control error';
}
</script>